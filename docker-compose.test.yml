version: '3'

services:
  unit_test:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.unit_test
    environment:
      - DB=postgresql://postgres:toor@db:5432
      - QUEUE_DATABASE_URL=postgresql://postgres:toor@queue:5432/bcda_queue
      - ATO_PUBLIC_KEY_FILE=../shared_files/ATO_public.pem
      - ATO_PRIVATE_KEY_FILE=../shared_files/ATO_private.pem
    volumes:
      - .:/go/src/github.com/CMSgov/bcda-app
  smoke_test:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.smoke_test
    volumes:
      - ./test:/go/src/github.com/CMSgov/bcda-app/test
  integration_test:
    build:
      context: .
      dockerfile: Dockerfiles/Dockerfile.integration_test
    volumes:
      - ./test:/go/src/github.com/CMSgov/bcda-app/test
